---
title: "Reproducibility Report"
output:
  html_document:
    toc: true
    toc_float: true
---

[TEXT IN SQUARE BRACKETS IS HERE FOR GUIDANCE. PLEASE DELETE TEXT IN SQUARE BRACKETS BEFORE KNITTING THE FINAL REPORT]

# Report Details

[PILOT/COPILOT ENTER RELEVANT REPORT DETAILS HERE]

```{r}
articleID <- 6-7-2014 # insert the article ID code here e.g., "10-3-2015"
reportType <- "pilot" # specify whether this is the 'pilot' report or 'copilot' report
pilotNames <- "Philip Hernandez" # insert the pilot's name here e.g., "Tom Hardwicke".
copilotNames <- "Adrian Apaza" # # insert the co-pilot's name here e.g., "Michael Frank".
pilotTTC <- 180 # insert the pilot's estimated time to complete (in minutes, it is fine to approximate) e.g., 120
copilotTTC <- NA # insert the co-pilot's estimated time to complete (in minutes, it is fine to approximate) e.g., 120
pilotStartDate <- 11/03/19 # insert the piloting start date in US format e.g., as.Date("01/25/18", format = "%m/%d/%y")
copilotStartDate <- NA # insert the co-piloting start date in US format e.g., as.Date("01/25/18", format = "%m/%d/%y")
completionDate <- NA # insert the date of final report completion in US format e.g., as.Date("01/25/18", format = "%m/%d/%y")
```

------

#### Methods summary:

Participants were recruited equally from the Westbound and Eastbound platforms at the Bay Street subway station stop in Toronto, Canada and asked to rate the distance to the upcoming (same direction as travel) stations and previous (opposite direction as travel) station stops on a scale of 1 (very close) to 7 (very far). The subjects were randomly assigned to rate the distance to one of the four closest stations, Bloor-Yonge (1 stop away, eastbound), Sherbourne (2 stops away, eastbound), St. George (1 stop away, westbound) and Spadina (2 stops away, westbound). 


------

#### Target outcomes:

We carried out a 2 (orientation: toward, away from) × 4 (station: Spadina, St. George, Bloor-Yonge, Sherbourne) analysis of variance (ANOVA) on closeness ratings, which revealed no main effect of orientation, F < 1, and a main effect of station, F(3, 194) = 24.10, p < .001, ηp2 = .27. This main effect was qualified by the predicted interaction between orientation and station, F(3, 194) = 16.28, p < .001, ηp2 = .20. We decomposed this interaction by the subjective-distance ratings between participants traveling east and west for each of the four subway stations. Westbound participants rated the stations to the west of Bay Street as closer than did eastbound participants; this effect was obtained for both the station one stop to the west (St. George, p < .001, ηp2 = .28) and the station two stops to the west (Spadina, p = .001, ηp2 = .20). The opposite pattern held true for stations to the east of Bay Street. Eastbound participants rated the stations to the east of Bay Street as closer than did westbound participants; this effect was obtained for both the station one stop to the east (Bloor-Yonge, p = .053, ηp2 = .08) and the station two stops to the east (Sherbourne, p < .001, ηp2 = .24). Figure 1 summarizes these results.



------

```{r global_options, include=FALSE}
# sets up some formatting options for the R Markdown document
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
```

# Step 1: Load packages and prepare report object


```{r}
# load packages
library(tidyverse) # for data munging
library(knitr) # for kable table formating
library(haven) # import and export 'SPSS', 'Stata' and 'SAS' Files
library(readxl) # import excel files
library(ReproReports) # custom reporting functions
library(here) # allows for relative paths
library(heplots) #Visualization of hypothesis testing, used here for ANOVA effect sizes

```



```{r}
# Prepare report object. This will be updated automatically by the reproCheck function each time values are compared
reportObject <- data.frame(dummyRow = TRUE, reportedValue = NA, obtainedValue = NA, valueType = NA, percentageError = NA, comparisonOutcome = NA, eyeballCheck = NA)
```

# Step 2: Load data

```{r}
S1_Subway <- read_excel(here("GroupB_6-7-2014/data/S1_Subway.xlsx"))
View(S1_Subway)
```

# Step 3: Tidy data

```{r}
```
Data is already in tidy format. No additional formatting necessary.

# Step 4: Run analysis

## Pre-processing

```{r}

```

## Descriptive statistics

Stations are numbered as follows:

1- Spadina 
2- St. George
3- Bloor-Yonge
4- Sherbourne 

Bay Station is in between St.George and Bloor-Yonge

Descriptive Statistics ignoring direction of platform
```{r}
S1_means_absolute <- S1_Subway %>% 
  group_by (STN_NUMBER) %>% # 
  summarise(dist = mean(DISTANCE), #
            stand_error = sd(DISTANCE)/sqrt(length(DISTANCE)), #Standard Error Calculation stdev/sqrt(num_obs)
            num_observations = length(DISTANCE)) #number of observations
S1_means_absolute
```

Descriptive Statistics incorporting direction of platform

```{r}
S1_means_directional <- S1_Subway %>% 
  group_by (DIRECTION, STN_NUMBER) %>% # 
  summarise(dist = mean(DISTANCE), #
            stand_error = sd(DISTANCE)/sqrt(length(DISTANCE)), #Standard Error Calculation stdev/sqrt(num_obs)
            num_observations = length(DISTANCE)) #number of observations
S1_means_directional
```

## Inferential statistics

2 x 4 ANOVA on closeness ratings 


```{r}
S1_data <- S1_Subway
aov.S1 <- aov (DISTANCE~DIRECTION*STN_NAME, data=S1_data)
aov.S1
summary(aov.S1)
etasq(aov.S1)
```

Calculate separate ANOVA for each direction
```{r}
S1_data_east <- filter(S1_Subway, DIRECTION == "WEST" )
aov.S1_e <- aov (DISTANCE~STN_NAME, data=S1_data_east)
aov.S1_e
summary(aov.S1_e)
etasq(aov.S1_e)
```

```{r}
East_1 <- S1_data 
  East_1 <- filter(East_1, DIRECTION == "EAST",   STN_NUMBER ==1)
 East_1 %>% 
   select(DISTANCE) 
West_1 <- S1_data 
  West_1 <- filter(West_1, DIRECTION == "WEST",   STN_NUMBER ==1)
 West_1 %>% 
   select(DISTANCE)
t.test(East_1, West_1)
```


# Step 5: Conclusion

[Please include a text summary describing your findings. If this reproducibility check was a failure, you should note any suggestions as to what you think the likely cause(s) might be.]


[PILOT/COPILOT DOD NOT EDIT THE CODE CHUNK BELOW]

```{r}
reportObject <- reportObject %>%
  filter(dummyRow == FALSE) %>% # remove the dummy row
  select(-dummyRow) %>% # remove dummy row designation
  mutate(articleID = articleID) %>% # add variables to report
  select(articleID, everything()) # make articleID first column

# decide on final outcome
if(any(reportObject$comparisonOutcome %in% c("MAJOR_ERROR", "DECISION_ERROR"))){
  finalOutcome <- "Failure"
}else{
  finalOutcome <- "Success"
}

# collate report extra details
reportExtras <- data.frame(articleID, pilotNames, copilotNames, pilotTTC, copilotTTC, pilotStartDate, copilotStartDate, completionDate, finalOutcome)

# save report objects
if(reportType == "pilot"){
  write_csv(reportObject, "pilotReportDetailed.csv")
  write_csv(reportExtras, "pilotReportExtras.csv")
}

if(reportType == "copilot"){
  write_csv(reportObject, "copilotReportDetailed.csv")
  write_csv(reportExtras, "copilotReportExtras.csv")
}
```

# Session information

[This function will output information about the package versions used in this report:]

```{r session_info, include=TRUE, echo=TRUE, results='markup'}
devtools::session_info()
```